{% extends 'base.html' %} {% block content %}
<main>
  <h2>Welcome to Assignment Week 2</h2>
  <form id="login-form" action="/login" method="post">
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" />
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" />
    <button class="button" type="submit">Log in</button>
  </form>
  <p>
    Don't have an account?
    <a href="/register">Register here</a>
  </p>
</main>

<script>
  const loginForm = document.getElementById("login-form");
  loginForm.addEventListener("submit", async (event) => {
    event.preventDefault();

    const formData = new FormData(loginForm);
    const response = await fetch(loginForm.action, {
      method: "POST",
      body: formData,
    });

    const result = await response.json();
    if (result.redirect) {
      window.location.href = result.redirect;
    }
  });
</script>
{% endblock content %}
